=== Cart Manager ===
Contributors: zito
Tags: woocommerce, cart, split order, multi-supplier, supplier, preorder, shipping class, temperature, 購物車, 拆單, 供應商, 預購, 溫層
Stable tag: 1.1.0
License: GPLv2 or later

提供先進的 WooCommerce 購物車驗證規則與管理功能。

此插件專為需要管理多供應商、預購商品和不同溫層（運送類別）的複雜商店而設計。它實現了強大的「多供應商分車結帳」與「自動拆單」功能，並為供應商提供了專屬的後台權限。

== 功能特色 (Features) ==

* **多供應商結帳與自動拆單 (Multi-Supplier Checkout & Order Splitting)**
    * 購物車頁面依供應商自動分組，並提供「勾選框」讓顧客選擇本次要結帳的供應商。
    * 顧客確認結帳後，系統會暫時移除未勾選的商品，僅針對所選供應商進行結帳。
    * 訂單成立後（例如狀態變為「處理中」），系統會自動將父訂單拆分為多張子訂單，每個供應商一張。
    * 子訂單會完整複製父訂單的運費、帳單/運送地址等資訊。
    * 在「感謝頁面」會顯示一個包含父訂單與所有子訂單的摘要表格，取代預設的訂單詳情。
    * 結帳完成後，先前未結帳的商品會自動還原到購物車中。
    * Mini-Cart (迷你購物車) 的結帳按鈕會被強制導向至主購物車頁面，以確保勾選邏輯被執行。

* **供應商角色 (Supplier Role) 管理**
    * 新增一個「供應商」(`supplier`) 使用者角色，其權限大致複製自「商店經理」。
    * 允許供應商角色登入 WordPress 後台 (`/wp-admin`)。
    * 供應商登入後，後台選單會被簡化，且在訂單列表中「只能」看見屬於他們自己的訂單。

* **進階商品 Meta 管理 (商品後台)**
    * **供應商：** 可在商品編輯頁面（包含簡單商品與可變商品）指定供應商。商品列表支援「供應商」欄位與批次編輯。
    * **預購：** 可在商品編輯頁面（包含簡單商品與「變化類型」）標記為「預購商品」。商品列表支援「預購」欄位與批次編輯。
    * **溫層：** 利用內建「運送類別」作為溫層標記。商品列表新增「運送類別」欄位。

* **進階訂單 Meta 管理 (訂單後台)**
    * 訂單成立時，自動將商品的「供應商 ID」、「預購狀態」、「溫層資料」 儲存為訂單 Meta。
    * 訂單列表新增「供應商」、「預購狀態」、「溫層」欄位，並支援依據這些欄位進行「篩選」。
    * 提供批次操作，可「重新檢查供應商」 或「檢查溫層」。

* **進階購物車驗證 (Cart Validation)**
    * 在購物車頁面，JavaScript 會阻止顧客同時勾選「不同溫層」（運送類別）的供應商進行結帳。
    * 「全選」功能會依據「預購/現貨」狀態進行分組全選，以利顧客操作。

== 安裝 (Installation) ==

1.  上傳 `cart-manager` 資料夾到 `/wp-content/plugins/` 目錄。
2.  在 WordPress 的「外掛」選單中啟用「Cart Manager」。
3.  **(重要)** 請先至 WooCommerce -> 設定 -> 運送 -> 運送類別 (Shipping Classes) 中，建立您需要的溫層（例如：常溫、冷凍、冷藏）。
4.  **(重要)** 請先至「使用者」->「新增使用者」，並建立角色為「供應商」的使用者帳號。
5.  **(重要)** 請至「商品」中，為您的商品分別設定「供應商」與「運送類別」（溫層）。

== 螢幕截圖 (Screenshots) ==

1.  商品編輯頁面：顯示「供應商」下拉選單與「預購」勾選框。
2.  商品列表：顯示「供應商」、「預購」、「運送類別」欄位與篩選器。
3.  購物車頁面：展示依供應商分組的商品，以及每個供應商前方的勾選框。
4.  購物車頁面 (衝突)：顯示當顧客試圖勾選不同溫層商品時的錯誤提示。
5.  訂單列表 (管理員)：顯示「供應商」、「預購狀態」、「溫層」欄位與篩選器。
6.  訂單列表 (供應商)：顯示供應商登入後，只能看見自己的訂單。
7.  感謝頁面：展示訂單被拆分後的父/子訂單摘要表格。

== 更新日誌 (Changelog) ==

= 1.1.0 =
* 優化：新增贈品不分單功能。

= 1.0.0 =
* 插件初始版本。